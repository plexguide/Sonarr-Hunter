{% extends "base.html" %}
{% set active_page = 'settings' %}

{% block title %}Huntarr - Settings{% endblock %}

{% block content %}
<div id="settingsContainer" class="content-section">
    <!-- App Selector Tabs -->
    <div class="app-selector">
        <button class="app-tab active" data-app="sonarr">Sonarr</button>
        <button class="app-tab" data-app="radarr">Radarr</button>
        <button class="app-tab" data-app="lidarr">Lidarr</button>
        <button class="app-tab" data-app="readarr">Readarr</button>
    </div>

    <div class="settings-form">
        <div id="settingsApp" class="settings-app-content">
            <!-- App-specific settings will be loaded here -->
        </div>
        
        <!-- Sonarr Settings -->
        <div id="sonarrSettings" class="app-settings">
            <h2>Sonarr Settings</h2>
            
            <!-- Add buttons here near the top -->
            <div class="settings-buttons top-buttons">
                <button id="saveSettings" class="save-button">Save Settings</button>
                <button id="resetSettings" class="reset-button">Reset to Defaults</button>
            </div>
            
            <div class="settings-group">
                <h3>Connection Settings</h3>
                <div class="setting-item">
                    <label for="sonarr_api_url">Sonarr URL:</label>
                    <input type="text" id="sonarr_api_url" placeholder="http://your-sonarr-address:8989">
                    <p class="setting-help">URL to your Sonarr instance (e.g., http://localhost:8989)</p>
                </div>
                <div class="setting-item">
                    <label for="sonarr_api_key">API Key:</label>
                    <input type="text" id="sonarr_api_key" placeholder="Enter your Sonarr API key">
                    <p class="setting-help">Your Sonarr API key (found in Settings > General)</p>
                </div>
                <div class="setting-item">
                    <label>Connection Status:</label>
                    <span id="sonarrConnectionStatus" class="connection-badge not-connected">Not Connected</span>
                    <button id="testSonarrConnection" class="test-connection-button">Test Connection</button>
                </div>
            </div>
            
            <!-- Rest of Sonarr settings sections -->
            <!-- Hunt Settings -->
            <div class="settings-group">
                <h3>Hunt Settings</h3>
                <div class="setting-item">
                    <label for="hunt_missing_shows">Hunt Missing Shows:</label>
                    <input type="number" id="hunt_missing_shows" min="0" step="1">
                    <p class="setting-help">Maximum number of missing shows to process per cycle. Set to 0 to disable.</p>
                </div>
                <div class="setting-item">
                    <label for="hunt_upgrade_episodes">Hunt Upgrade Episodes:</label>
                    <input type="number" id="hunt_upgrade_episodes" min="0" step="1">
                    <p class="setting-help">Maximum number of episodes to upgrade per cycle. Set to 0 to disable.</p>
                </div>
            </div>
            
            <!-- Include other Sonarr settings sections (Timing Settings, Processing Options, Advanced Settings) -->
            <!-- ...existing code for other settings sections... -->
        </div>
        
        <!-- Radarr Settings (placeholder) -->
        <div id="radarrSettings" class="app-settings" style="display: none;">
            <!-- ...existing code for Radarr settings... -->
        </div>
        
        <!-- Lidarr Settings (placeholder) -->
        <div id="lidarrSettings" class="app-settings" style="display: none;">
            <!-- ...existing code for Lidarr settings... -->
        </div>
        
        <!-- Readarr Settings (placeholder) -->
        <div id="readarrSettings" class="app-settings" style="display: none;">
            <!-- ...existing code for Readarr settings... -->
        </div>
        
        <div class="settings-buttons">
            <button id="saveSettingsBottom" class="save-button">Save Settings</button>
            <button id="resetSettingsBottom" class="reset-button">Reset to Defaults</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Settings-specific JavaScript
        
        // Setup app tab switching
        const appTabs = document.querySelectorAll('.app-tab');
        const appSettings = document.querySelectorAll('.app-settings');
        
        appTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const app = this.dataset.app;
                
                // If it's already the active app, do nothing
                if (app === currentApp) return;
                
                // Update active tab
                appTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update active settings panel
                appSettings.forEach(s => s.style.display = 'none');
                document.getElementById(`${app}Settings`).style.display = 'block';
                
                // Update current app
                currentApp = app;
                
                // Load settings for this app
                loadSettings(app);
            });
        });
        
        // Load settings for initial app
        loadSettings(currentApp);
    });
</script>
{% endblock %}
