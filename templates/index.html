<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huntarr</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="icon" href="/static/favicon.ico">
    <script>
        // Apply theme immediately to prevent flash
        const storedTheme = localStorage.getItem('huntarrTheme');
        if (storedTheme === 'dark' || (!storedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark-theme');
            document.body.classList.add('dark-theme');
        }
    </script>
</head>
<body class="dark-theme">
    <div class="container">
        <div class="header">
            <h1><a href="/" class="title-link"><img src="https://github.com/plexguide/Huntarr/blob/main/logo/40.png?raw=true" alt="Huntarr Logo" class="huntarr-logo">Huntarr</a></h1>
            <div class="buttons">
                <button id="homeButton" class="active">Home</button>
                <button id="logsButton">Logs</button>
                <button id="settingsButton">Settings</button>
                <button id="userButton">User</button>
            </div>
            <div class="theme-toggle">
                <label class="switch">
                    <input type="checkbox" id="themeToggle" checked>
                    <span class="slider round"></span>
                </label>
                <span id="themeLabel">Dark Mode</span>
            </div>
        </div>

        <div id="homeContainer" class="content-section">
            <!-- Removed app selector tabs -->
            <div class="welcome-panel">
                <h2>Welcome to Huntarr, <span id="username">User</span>!</h2>
                <p>Huntarr helps you find missing media and upgrade quality across multiple Arr applications.</p>
                
                <h3>Connection Status</h3>
                <div class="connection-list">
                    <div class="connection-item">
                        <span class="connection-name">Sonarr:</span>
                        <span id="sonarrHomeStatus" class="connection-badge not-connected">Not Connected</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-name">Radarr:</span>
                        <span id="radarrHomeStatus" class="connection-badge not-connected">Not Connected</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-name">Lidarr:</span>
                        <span id="lidarrHomeStatus" class="connection-badge not-connected">Not Connected</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-name">Readarr:</span>
                        <span id="readarrHomeStatus" class="connection-badge not-connected">Not Connected</span>
                    </div>
                </div>
                
                <div class="info-box">
                    <h3>Coming Soon</h3>
                    <p>Huntarr.io with a Discord community for support and developers.</p>
                    <p>To file issues, please visit: <a href="https://github.com/plexguide/Huntarr/issues" target="_blank">GitHub Issues</a></p>
                    <p>For documentation, check our <a href="https://github.com/plexguide/Huntarr/wiki" target="_blank">Wiki</a></p>
                </div>
                
                <div class="thank-you-box">
                    <h3>Special Thanks</h3>
                    <p>Thank you to <a href="https://github.com/zpatten" target="_blank">ZPatten</a> and <a href="https://github.com/MacaidenXIII" target="_blank">MacaidenXIII</a> for really getting this project kickstarted with great ideas!</p>
                    <p>Thank you to <a href="https://ninjacentral.co.za" target="_blank">ninjacentral.co.za</a> for the original inspired insight on API indexer issues which also inspired the program.</p>
                    <p>I thank my daughter who provides inspiration to do everything in life.</p>
                    <p>Thank you for using Huntarr ~ <a href="https://github.com/Admin9705/" target="_blank">Admin9705</a></p>
                </div>
            </div>
        </div>

        <div id="logsContainer" class="content-section" style="display: none;">
            <!-- App Selector Tabs (only for logs view) -->
            <div class="app-selector">
                <button class="app-tab active" data-app="sonarr">Sonarr</button>
                <button class="app-tab" data-app="radarr">Radarr</button>
                <button class="app-tab" data-app="lidarr">Lidarr</button>
                <button class="app-tab" data-app="readarr">Readarr</button>
            </div>
            <!-- Removed the countdown timer from the logs area -->
            <div class="logs-countdown" style="display: none;">
                <!-- Removed countdown display -->
            </div>
            <!-- Add a countdown display element for the logs page -->
            <div id="logCountdown" class="log-countdown"></div>
            <div class="log-controls">
                <div class="connection-status">
                    Status: <span id="status" class="status-disconnected">Disconnected</span>
                </div>
                <div class="auto-scroll">
                    <label>
                        <input type="checkbox" id="autoScroll" checked>
                        Auto-scroll
                    </label>
                </div>
                <button id="clearLogs" class="clear-button">Clear Logs</button>
            </div>
            <div id="logs" class="logs"></div>
        </div>

        <div id="settingsContainer" class="content-section" style="display: none;">
            <!-- App Selector Tabs (only for settings view) -->
            <div class="app-selector">
                <button class="app-tab active" data-app="sonarr">Sonarr</button>
                <button class="app-tab" data-app="radarr">Radarr</button>
                <button class="app-tab" data-app="lidarr">Lidarr</button>
                <button class="app-tab" data-app="readarr">Readarr</button>
            </div>

            <div class="settings-form">
                <div id="settingsApp" class="settings-app-content">
                    <!-- App-specific settings will be loaded here -->
                </div>
                
                <!-- Sonarr Settings -->
                <div id="sonarrSettings" class="app-settings">
                    <h2>Sonarr Settings</h2>
                    
                    <!-- Add buttons here near the top -->
                    <div class="settings-buttons top-buttons">
                        <button id="saveSettings" class="save-button">Save Settings</button>
                        <button id="resetSettings" class="reset-button">Reset to Defaults</button>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Connection Settings</h3>
                        <div class="setting-item">
                            <label for="sonarr_api_url">Sonarr URL:</label>
                            <input type="text" id="sonarr_api_url" placeholder="http://your-sonarr-address:8989">
                            <p class="setting-help">URL to your Sonarr instance (e.g., http://localhost:8989)</p>
                        </div>
                        <div class="setting-item">
                            <label for="sonarr_api_key">API Key:</label>
                            <input type="text" id="sonarr_api_key" placeholder="Enter your Sonarr API key">
                            <p class="setting-help">Your Sonarr API key (found in Settings > General)</p>
                        </div>
                        <div class="setting-item">
                            <label>Connection Status:</label>
                            <span id="sonarrConnectionStatus" class="connection-badge not-connected">Not Connected</span>
                            <button id="testSonarrConnection" class="test-connection-button">Test Connection</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Hunt Settings</h3>
                        <div class="setting-item">
                            <label for="hunt_missing_shows">Hunt Missing Shows:</label>
                            <input type="number" id="hunt_missing_shows" min="0" step="1">
                            <p class="setting-help">Maximum number of missing shows to process per cycle. Set to 0 to disable.</p>
                        </div>
                        <div class="setting-item">
                            <label for="hunt_upgrade_episodes">Hunt Upgrade Episodes:</label>
                            <input type="number" id="hunt_upgrade_episodes" min="0" step="1">
                            <p class="setting-help">Maximum number of episodes to upgrade per cycle. Set to 0 to disable.</p>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Timing Settings</h3>
                        <div class="setting-item">
                            <label for="sleep_duration">Sleep Duration (seconds):</label>
                            <div class="duration-input">
                                <input type="number" id="sleep_duration" min="60" step="60">
                                <span id="sleep_duration_hours">≈ 15 minutes</span>
                            </div>
                            <p class="setting-help">Time to wait between cycles in seconds (minimum 60 seconds)</p>
                        </div>
                        <div class="setting-item">
                            <label for="state_reset_interval_hours">State Reset Interval (hours):</label>
                            <input type="number" id="state_reset_interval_hours" min="0" step="1">
                            <p class="setting-help">Hours after which processed items will be forgotten. Set to 0 to never reset.</p>
                        </div>
                        <div class="setting-item">
                            <label for="log_refresh_interval_seconds">Log Refresh Interval (seconds):</label>
                            <input type="number" id="log_refresh_interval_seconds" min="0" step="1">
                            <p class="setting-help">Time interval for log refresh countdown. Set to 0 to disable.</p>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Processing Options</h3>
                        <div class="setting-item">
                            <label for="monitored_only">Monitored Only:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="monitored_only">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Only process monitored shows and episodes</p>
                        </div>
                        <div class="setting-item">
                            <label for="random_missing">Random Missing Shows:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="random_missing">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Select missing shows randomly instead of sequentially</p>
                        </div>
                        <div class="setting-item">
                            <label for="random_upgrades">Random Upgrades:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="random_upgrades">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Select upgrade episodes randomly instead of sequentially</p>
                        </div>
                        <div class="setting-item">
                            <label for="skip_future_episodes">Skip Future Episodes:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="skip_future_episodes">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Skip processing episodes with future air dates</p>
                        </div>
                        <div class="setting-item">
                            <label for="skip_series_refresh">Skip Series Refresh:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="skip_series_refresh">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Skip refreshing series metadata before processing (reduces disk activity)</p>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>Advanced Settings</h3>
                        <div class="setting-item">
                            <label for="api_timeout">API Timeout (seconds):</label>
                            <input type="number" id="api_timeout" min="10" step="1">
                            <p class="setting-help">Timeout in seconds for API requests to Sonarr (minimum 10 seconds)</p>
                        </div>
                        <div class="setting-item">
                            <label for="debug_mode">Debug Mode:</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="debug_mode">
                                <span class="toggle-slider"></span>
                            </label>
                            <p class="setting-help">Enable detailed debug logging (takes effect immediately)</p>
                        </div>
                        <div class="setting-item">
                            <label for="command_wait_delay">Command Wait Delay:</label>
                            <input type="number" id="command_wait_delay" min="1" step="1">
                            <p class="setting-help">Delay in seconds between checking for command status</p>
                        </div>
                        <div class="setting-item">
                            <label for="command_wait_attempts">Command Wait Attempts:</label>
                            <input type="number" id="command_wait_attempts" min="10" step="1">
                            <p class="setting-help">Number of attempts to check for command completion before giving up</p>
                        </div>
                        <div class="setting-item">
                            <label for="minimum_download_queue_size">Minimum Queue Size:</label>
                            <input type="number" id="minimum_download_queue_size" min="-1" step="1">
                            <p class="setting-help">Minimum items in download queue before starting hunt. Set to -1 to disable check.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Radarr Settings (placeholder) -->
                <div id="radarrSettings" class="app-settings" style="display: none;">
                    <h2>Radarr Settings</h2>
                    
                    <div class="settings-buttons top-buttons">
                        <button id="saveRadarrSettings" class="save-button">Save Settings</button>
                        <button id="resetRadarrSettings" class="reset-button">Reset to Defaults</button>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Connection Settings</h3>
                        <div class="setting-item">
                            <label for="radarr_api_url">Radarr URL:</label>
                            <input type="text" id="radarr_api_url" placeholder="http://your-radarr-address:7878">
                            <p class="setting-help">URL to your Radarr instance (e.g., http://localhost:7878)</p>
                        </div>
                        <div class="setting-item">
                            <label for="radarr_api_key">API Key:</label>
                            <input type="text" id="radarr_api_key" placeholder="Enter your Radarr API key">
                            <p class="setting-help">Your Radarr API key (found in Settings > General)</p>
                        </div>
                        <div class="setting-item">
                            <label>Connection Status:</label>
                            <span id="radarrConnectionStatus" class="connection-badge not-connected">Not Connected</span>
                            <button id="testRadarrConnection" class="test-connection-button">Test Connection</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Hunt Settings</h3>
                        <p class="service-not-configured">Radarr integration is not fully implemented yet. Please configure the connection settings first.</p>
                    </div>
                </div>
                
                <!-- Lidarr Settings (placeholder) -->
                <div id="lidarrSettings" class="app-settings" style="display: none;">
                    <h2>Lidarr Settings</h2>
                    
                    <div class="settings-buttons top-buttons">
                        <button id="saveLidarrSettings" class="save-button">Save Settings</button>
                        <button id="resetLidarrSettings" class="reset-button">Reset to Defaults</button>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Connection Settings</h3>
                        <div class="setting-item">
                            <label for="lidarr_api_url">Lidarr URL:</label>
                            <input type="text" id="lidarr_api_url" placeholder="http://your-lidarr-address:8686">
                            <p class="setting-help">URL to your Lidarr instance (e.g., http://localhost:8686)</p>
                        </div>
                        <div class="setting-item">
                            <label for="lidarr_api_key">API Key:</label>
                            <input type="text" id="lidarr_api_key" placeholder="Enter your Lidarr API key">
                            <p class="setting-help">Your Lidarr API key (found in Settings > General)</p>
                        </div>
                        <div class="setting-item">
                            <label>Connection Status:</label>
                            <span id="lidarrConnectionStatus" class="connection-badge not-connected">Not Connected</span>
                            <button id="testLidarrConnection" class="test-connection-button">Test Connection</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Hunt Settings</h3>
                        <p class="service-not-configured">Lidarr integration is not fully implemented yet. Please configure the connection settings first.</p>
                    </div>
                </div>
                
                <!-- Readarr Settings (placeholder) -->
                <div id="readarrSettings" class="app-settings" style="display: none;">
                    <h2>Readarr Settings</h2>
                    
                    <div class="settings-buttons top-buttons">
                        <button id="saveReadarrSettings" class="save-button">Save Settings</button>
                        <button id="resetReadarrSettings" class="reset-button">Reset to Defaults</button>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Connection Settings</h3>
                        <div class="setting-item">
                            <label for="readarr_api_url">Readarr URL:</label>
                            <input type="text" id="readarr_api_url" placeholder="http://your-readarr-address:8787">
                            <p class="setting-help">URL to your Readarr instance (e.g., http://localhost:8787)</p>
                        </div>
                        <div class="setting-item">
                            <label for="readarr_api_key">API Key:</label>
                            <input type="text" id="readarr_api_key" placeholder="Enter your Readarr API key">
                            <p class="setting-help">Your Readarr API key (found in Settings > General)</p>
                        </div>
                        <div class="setting-item">
                            <label>Connection Status:</label>
                            <span id="readarrConnectionStatus" class="connection-badge not-connected">Not Connected</span>
                            <button id="testReadarrConnection" class="test-connection-button">Test Connection</button>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <h3>Hunt Settings</h3>
                        <p class="service-not-configured">Readarr integration is not fully implemented yet. Please configure the connection settings first.</p>
                    </div>
                </div>
                
                <div class="settings-buttons">
                    <button id="saveSettingsBottom" class="save-button">Save Settings</button>
                    <button id="resetSettingsBottom" class="reset-button">Reset to Defaults</button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>💰 Donate @ <a href="https://donate.plex.one" target="_blank">donate.plex.one</a> for Daughter's College Fund! ⭐ Also Star <a href="https://github.com/plexguide/huntarr" target="_blank">Huntarr on GitHub</a> if you find it useful!</p>
        </div>
    </div>

    <script src="/static/js/main.js"></script>
    <script>
        // Apply immediate theme and prevent flashing on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Apply theme from localStorage immediately
            const storedTheme = localStorage.getItem('huntarrTheme');
            if (storedTheme === 'dark' || (!storedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark-theme');
                document.body.classList.add('dark-theme');
                const themeToggle = document.getElementById('themeToggle');
                const themeLabel = document.getElementById('themeLabel');
                if (themeToggle) themeToggle.checked = true;
                if (themeLabel) themeLabel.textContent = 'Dark Mode';
            }
        });
    </script>
</body>
</html>